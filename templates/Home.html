{% extends 'base.html' %}
{% load static %}
{% block title %} Django Starter {% endblock title %}
{% load custom_tags %}
<!-- Specific CSS goes HERE -->
{% block stylesheets %}
<style>
    .feature-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        cursor: pointer;
    }
    .feature-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    }
    .feature-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
    }
    .section-title {
        border-bottom: 3px solid #5e72e4;
        padding-bottom: 10px;
        margin-bottom: 30px;
    }
</style>
{% endblock stylesheets %}

{% block content %}

<div class="container-fluid py-4">
    <!-- Hero Section -->
    <div class="row mb-5">
        <div class="col-12 text-center">
            <h1 class="display-3 font-weight-bold">Django Starter Project</h1>
            <p class="lead">A comprehensive Django starter template with authentication, file management, and async task processing</p>
        </div>
    </div>

    <!-- File Manager Section v2 -->
    <div class="row mb-5">
        <div class="col-12">
            <h2 class="section-title"><i class="fa-solid fa-folder-open"></i> File Manager (3 Levels)</h2>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'upload_public_file' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-primary">
                        <i class="fa-solid fa-upload"></i>
                    </div>
                    <h3 class="card-title">Public Files</h3>
                    <p class="card-text">Accessible to everyone without login</p>
                    <a href="{% url 'upload_public_file' %}" class="btn btn-primary">Go to Public Upload</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'upload_protected_file' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-warning">
                        <i class="fa-solid fa-shield-halved"></i>
                    </div>
                    <h3 class="card-title">Protected Files</h3>
                    <p class="card-text">Requires authentication to access</p>
                    <a href="{% url 'upload_protected_file' %}" class="btn btn-warning">Go to Protected Upload</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'upload_private_file' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-success">
                        <i class="fa-solid fa-lock"></i>
                    </div>
                    <h3 class="card-title">Private Files</h3>
                    <p class="card-text">User-specific with signed URLs</p>
                    <a href="{% url 'upload_private_file' %}" class="btn btn-success">Go to Private Upload</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Celery Progress Section -->
    <div class="row mb-5">
        <div class="col-12">
            <h2 class="section-title"><i class="fa-solid fa-gears"></i> Async Task Processing</h2>
        </div>
        <div class="col-12">
            <div class="card feature-card">
                <div class="card-body">
                    <div class="text-center mb-4">
                        <div class="feature-icon text-info">
                            <i class="fa-solid fa-spinner"></i>
                        </div>
                        <h3 class="card-title">Celery Progress Tracking</h3>
                        <p class="card-text">Real-time WebSocket progress updates for long-running tasks</p>
                    </div>
                    <div class="row">
                        <div class="col-md-6 offset-md-3 text-center">
                            <button id="start-task" class="btn btn-info btn-lg mb-3">
                                <i class="fa-solid fa-play"></i> Start Long Running Task
                            </button>
                            <div id="progress-bar-container" style="display: none;">
                                <div class="progress" style="height: 30px; background-color: #e9ecef; border-radius: 5px;">
                                    <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" 
                                         role="progressbar" style="width: 0%; height: 100%; line-height: 30px; font-size: 14px; font-weight: bold;">0%</div>
                                </div>
                                <p id="progress-description" class="text-center mt-2"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- RabbitMQ Message Queue Section -->
    <div class="row mb-5">
        <div class="col-12">
            <h2 class="section-title"><i class="fa-solid fa-envelope-open-text"></i> Message Queue (RabbitMQ)</h2>
        </div>
        <div class="col-md-6 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'send_notification' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-primary">
                        <i class="fa-solid fa-paper-plane"></i>
                    </div>
                    <h3 class="card-title">Send Notification</h3>
                    <p class="card-text">Publish priority-based notifications to RabbitMQ</p>
                    <a href="{% url 'send_notification' %}" class="btn btn-primary">Send Message</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'notification_dashboard' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-info">
                        <i class="fa-solid fa-chart-line"></i>
                    </div>
                    <h3 class="card-title">Notification Dashboard</h3>
                    <p class="card-text">View notification statistics and message history</p>
                    <a href="{% url 'notification_dashboard' %}" class="btn btn-info">View Dashboard</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Kafka Event Streaming Section -->
    <div class="row mb-5">
        <div class="col-12">
            <h2 class="section-title"><i class="fa-solid fa-stream"></i> Event Streaming (Kafka)</h2>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'publish_event' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-success">
                        <i class="fa-solid fa-bolt"></i>
                    </div>
                    <h3 class="card-title">Publish Event</h3>
                    <p class="card-text">Send events to Kafka for real-time processing</p>
                    <a href="{% url 'publish_event' %}" class="btn btn-success">Publish Event</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'event_dashboard' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-warning">
                        <i class="fa-solid fa-table"></i>
                    </div>
                    <h3 class="card-title">Event Dashboard</h3>
                    <p class="card-text">Monitor events and session statistics</p>
                    <a href="{% url 'event_dashboard' %}" class="btn btn-warning">View Events</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'event_analytics' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-danger">
                        <i class="fa-solid fa-chart-pie"></i>
                    </div>
                    <h3 class="card-title">Analytics</h3>
                    <p class="card-text">View aggregated event analytics and insights</p>
                    <a href="{% url 'event_analytics' %}" class="btn btn-danger">View Analytics</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Elasticsearch Section -->
    <div class="row mb-5">
        <div class="col-12">
            <h2 class="section-title"><i class="fa-solid fa-magnifying-glass"></i> Elasticsearch Search</h2>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'elasticsearch_app:dashboard' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-primary">
                        <i class="fa-solid fa-gauge-high"></i>
                    </div>
                    <h3 class="card-title">Dashboard</h3>
                    <p class="card-text">Monitor cluster health, indices, and manage documents</p>
                    <a href="{% url 'elasticsearch_app:dashboard' %}" class="btn btn-primary">View Dashboard</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'elasticsearch_app:search' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-success">
                        <i class="fa-solid fa-search"></i>
                    </div>
                    <h3 class="card-title">Search</h3>
                    <p class="card-text">Full-text search with autocomplete and filters</p>
                    <a href="{% url 'elasticsearch_app:search' %}" class="btn btn-success">Search Now</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'elasticsearch_app:analytics' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-warning">
                        <i class="fa-solid fa-chart-line"></i>
                    </div>
                    <h3 class="card-title">Analytics</h3>
                    <p class="card-text">View search query analytics and insights</p>
                    <a href="{% url 'elasticsearch_app:analytics' %}" class="btn btn-warning">View Analytics</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Account Management Section -->
    <div class="row mb-5">
        <div class="col-12">
            <h2 class="section-title"><i class="fa-solid fa-user"></i> Account Management</h2>
        </div>
        {% if user.is_authenticated %}
        <div class="col-md-6 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'account' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-warning">
                        <i class="fa-solid fa-user-gear"></i>
                    </div>
                    <h3 class="card-title">My Account</h3>
                    <p class="card-text">Manage your profile and account settings</p>
                    <a href="{% url 'account' %}" class="btn btn-warning">View Profile</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'logout' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-danger">
                        <i class="fa-solid fa-right-from-bracket"></i>
                    </div>
                    <h3 class="card-title">Logout</h3>
                    <p class="card-text">Sign out from your account</p>
                    <a href="{% url 'logout' %}" class="btn btn-danger">Logout</a>
                </div>
            </div>
        </div>
        {% else %}
        <div class="col-md-6 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'login' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-success">
                        <i class="fa-solid fa-right-to-bracket"></i>
                    </div>
                    <h3 class="card-title">Login</h3>
                    <p class="card-text">Sign in to your account</p>
                    <a href="{% url 'login' %}" class="btn btn-success">Login</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'register' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-primary">
                        <i class="fa-solid fa-user-plus"></i>
                    </div>
                    <h3 class="card-title">Register</h3>
                    <p class="card-text">Create a new account with email verification</p>
                    <a href="{% url 'register' %}" class="btn btn-primary">Sign Up</a>
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Notes App Section - Django Generic Views -->
    <div class="row mb-5">
        <div class="col-12">
            <h2 class="section-title"><i class="fa-solid fa-note-sticky"></i> Notes App (Django Generic Views)</h2>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'notes_app:home' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-primary">
                        <i class="fa-solid fa-house"></i>
                    </div>
                    <h3 class="card-title">Notes Home</h3>
                    <p class="card-text">TemplateView with statistics and overview</p>
                    <a href="{% url 'notes_app:home' %}" class="btn btn-primary">Go to Notes</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'notes_app:note_list' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-info">
                        <i class="fa-solid fa-list"></i>
                    </div>
                    <h3 class="card-title">All Notes</h3>
                    <p class="card-text">ListView with filtering and pagination</p>
                    <a href="{% url 'notes_app:note_list' %}" class="btn btn-info">Browse Notes</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'notes_app:note_create' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-success">
                        <i class="fa-solid fa-plus"></i>
                    </div>
                    <h3 class="card-title">Create Note</h3>
                    <p class="card-text">CreateView with form handling</p>
                    <a href="{% url 'notes_app:note_create' %}" class="btn btn-success">New Note</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'notes_app:category_list' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-warning">
                        <i class="fa-solid fa-folder"></i>
                    </div>
                    <h3 class="card-title">Categories</h3>
                    <p class="card-text">ListView & DetailView for categories</p>
                    <a href="{% url 'notes_app:category_list' %}" class="btn btn-warning">View Categories</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'notes_app:tag_list' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-secondary">
                        <i class="fa-solid fa-tags"></i>
                    </div>
                    <h3 class="card-title">Tags</h3>
                    <p class="card-text">ListView with aggregation</p>
                    <a href="{% url 'notes_app:tag_list' %}" class="btn btn-secondary">View Tags</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'notes_app:random_note' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-danger">
                        <i class="fa-solid fa-random"></i>
                    </div>
                    <h3 class="card-title">Random Note</h3>
                    <p class="card-text">RedirectView to random content</p>
                    <a href="{% url 'notes_app:random_note' %}" class="btn btn-danger">Random Note</a>
                </div>
            </div>
        </div>
    </div>

    <!-- REST API Section -->
    <div class="row mb-5">
        <div class="col-12">
            <h2 class="section-title"><i class="fa-solid fa-code"></i> REST API (Django REST Framework)</h2>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='/api/docs/'">
                <div class="card-body text-center">
                    <div class="feature-icon text-primary">
                        <i class="fa-solid fa-book-open"></i>
                    </div>
                    <h3 class="card-title">Swagger Docs</h3>
                    <p class="card-text">Interactive API documentation</p>
                    <a href="/api/docs/" class="btn btn-primary">Open Swagger</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='/api/redoc/'">
                <div class="card-body text-center">
                    <div class="feature-icon text-info">
                        <i class="fa-solid fa-file-code"></i>
                    </div>
                    <h3 class="card-title">ReDoc</h3>
                    <p class="card-text">Alternative API documentation</p>
                    <a href="/api/redoc/" class="btn btn-info">Open ReDoc</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='/api/v1/'">
                <div class="card-body text-center">
                    <div class="feature-icon text-success">
                        <i class="fa-solid fa-server"></i>
                    </div>
                    <h3 class="card-title">API Root</h3>
                    <p class="card-text">Browse the REST API endpoints</p>
                    <a href="/api/v1/" class="btn btn-success">Browse API</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='/api/v1/products/'">
                <div class="card-body text-center">
                    <div class="feature-icon text-warning">
                        <i class="fa-solid fa-box"></i>
                    </div>
                    <h3 class="card-title">Products API</h3>
                    <p class="card-text">ModelViewSet with full CRUD</p>
                    <a href="/api/v1/products/" class="btn btn-warning">Products</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='/api/v1/health/'">
                <div class="card-body text-center">
                    <div class="feature-icon text-secondary">
                        <i class="fa-solid fa-heartbeat"></i>
                    </div>
                    <h3 class="card-title">Health Check</h3>
                    <p class="card-text">APIView for health status</p>
                    <a href="/api/v1/health/" class="btn btn-secondary">Health</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='/api/v1/search/?q=test'">
                <div class="card-body text-center">
                    <div class="feature-icon text-danger">
                        <i class="fa-solid fa-search"></i>
                    </div>
                    <h3 class="card-title">Global Search</h3>
                    <p class="card-text">Custom APIView for search</p>
                    <a href="/api/v1/search/?q=test" class="btn btn-danger">Search API</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Commands App Section - Management Commands -->
    <div class="row mb-5">
        <div class="col-12">
            <h2 class="section-title"><i class="fa-solid fa-terminal"></i> Commands App (Management Commands Demo)</h2>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'commands_app:dashboard' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-primary">
                        <i class="fa-solid fa-dashboard"></i>
                    </div>
                    <h3 class="card-title">Dashboard</h3>
                    <p class="card-text">TemplateView with stats</p>
                    <a href="{% url 'commands_app:dashboard' %}" class="btn btn-primary">View Dashboard</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'commands_app:task_list' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-success">
                        <i class="fa-solid fa-calendar-check"></i>
                    </div>
                    <h3 class="card-title">Scheduled Tasks</h3>
                    <p class="card-text">ListView, CreateView, UpdateView, DeleteView</p>
                    <a href="{% url 'commands_app:task_list' %}" class="btn btn-success">View Tasks</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'commands_app:run_command' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-warning">
                        <i class="fa-solid fa-play"></i>
                    </div>
                    <h3 class="card-title">Run Command</h3>
                    <p class="card-text">FormView to execute commands</p>
                    <a href="{% url 'commands_app:run_command' %}" class="btn btn-warning">Run Command</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'commands_app:log_list' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-info">
                        <i class="fa-solid fa-file-text"></i>
                    </div>
                    <h3 class="card-title">Command Logs</h3>
                    <p class="card-text">ListView with DetailView</p>
                    <a href="{% url 'commands_app:log_list' %}" class="btn btn-info">View Logs</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'commands_app:metrics_dashboard' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-secondary">
                        <i class="fa-solid fa-chart-line"></i>
                    </div>
                    <h3 class="card-title">System Metrics</h3>
                    <p class="card-text">TemplateView with charts</p>
                    <a href="{% url 'commands_app:metrics_dashboard' %}" class="btn btn-secondary">View Metrics</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card feature-card" onclick="window.location.href='{% url 'commands_app:import_list' %}'">
                <div class="card-body text-center">
                    <div class="feature-icon text-danger">
                        <i class="fa-solid fa-download"></i>
                    </div>
                    <h3 class="card-title">Data Import/Export</h3>
                    <p class="card-text">ListView for data operations</p>
                    <a href="{% url 'commands_app:import_list' %}" class="btn btn-danger">View Imports</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Features List -->
    <div class="row">
        <div class="col-12">
            <h2 class="section-title"><i class="fa-solid fa-list-check"></i> Included Features</h2>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card h-100">
                <div class="card-body">
                    <h4><i class="fa-solid fa-envelope text-primary"></i> Email Verification</h4>
                    <ul class="list-unstyled">
                        <li><i class="fa-solid fa-check text-success"></i> Mailjet integration</li>
                        <li><i class="fa-solid fa-check text-success"></i> Secure token generation</li>
                        <li><i class="fa-solid fa-check text-success"></i> Email activation flow</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card h-100">
                <div class="card-body">
                    <h4><i class="fa-solid fa-database text-info"></i> Celery + Redis</h4>
                    <ul class="list-unstyled">
                        <li><i class="fa-solid fa-check text-success"></i> Async task processing</li>
                        <li><i class="fa-solid fa-check text-success"></i> WebSocket progress tracking</li>
                        <li><i class="fa-solid fa-check text-success"></i> Real-time updates</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card h-100">
                <div class="card-body">
                    <h4><i class="fa-solid fa-flask text-warning"></i> Testing Suite</h4>
                    <ul class="list-unstyled">
                        <li><i class="fa-solid fa-check text-success"></i> pytest + pytest-django</li>
                        <li><i class="fa-solid fa-check text-success"></i> 60+ comprehensive tests</li>
                        <li><i class="fa-solid fa-check text-success"></i> CI/CD integration</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Getting Started -->
    <div class="row mt-5">
        <div class="col-12">
            <div class="card bg-gradient-primary text-white">
                <div class="card-body text-center p-5">
                    <h2><i class="fa-brands fa-github"></i> Start Your Own Project</h2>
                    <p class="lead">This is a comprehensive Django starter template ready for production deployment</p>
                    <a href="https://github.com/arpansahu/django_starter" target="_blank" class="btn btn-light btn-lg">
                        <i class="fa-brands fa-github"></i> View on GitHub
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock content %}

<!-- Specific JS goes HERE -->
{% block javascripts %}
    <script src="{% static 'celery_progress/celery_progress.js' %}"></script>
    <script src="{% static 'celery_progress/celery_websocket.js' %}"></script>
    <script>
        document.getElementById('start-task').addEventListener('click', function() {
            const button = this;
            button.disabled = true;
            button.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Starting...';
            
            fetch('{% url "start-task" %}', {
                method: 'POST',
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}',
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                const taskId = data.task_id;
                const progressContainer = document.getElementById('progress-bar-container');
                progressContainer.style.display = 'block';
                
                // Initialize WebSocket progress bar
                const progressUrl = '/ws/progress/' + taskId + '/';
                CeleryWebSocketProgressBar.initProgressBar(progressUrl, {
                    progressBarId: 'progress-bar',
                    progressBarMessageId: 'progress-description',
                    onProgress: function(progressBarElement, progressBarMessageElement, progress) {
                        if (progress.percent !== undefined) {
                            progressBarElement.style.width = progress.percent + '%';
                            progressBarElement.textContent = Math.round(progress.percent) + '%';
                        }
                        if (progress.description) {
                            progressBarMessageElement.textContent = progress.description;
                        } else {
                            progressBarMessageElement.textContent = progress.current + ' of ' + progress.total + ' processed';
                        }
                    },
                    onSuccess: function(progressBarElement, progressBarMessageElement, result) {
                        progressBarElement.style.width = '100%';
                        progressBarElement.textContent = '100%';
                        progressBarElement.classList.remove('progress-bar-animated');
                        progressBarElement.classList.add('bg-success');
                        progressBarMessageElement.textContent = 'Task completed successfully!';
                        button.disabled = false;
                        button.innerHTML = '<i class="fa-solid fa-play"></i> Start Long Running Task';
                    },
                    onError: function(progressBarElement, progressBarMessageElement, error) {
                        console.error('Progress error:', error);
                        progressBarElement.classList.add('bg-danger');
                        progressBarMessageElement.textContent = 'Error: ' + error;
                        button.disabled = false;
                        button.innerHTML = '<i class="fa-solid fa-play"></i> Start Long Running Task';
                    }
                });
            })
            .catch(error => {
                console.error('Error starting task:', error);
                button.disabled = false;
                button.innerHTML = '<i class="fa-solid fa-play"></i> Start Long Running Task';
                alert('Failed to start task. Please try again.');
            });
        });
    </script>
{% endblock javascripts %}